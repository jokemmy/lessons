
## 运算符详解

---

### “+” 运算符

二元加法运算符，可以对两个数字做加法，也可以做字符串连接操作。

同时也是一个一元运算符

---

### “+” 与原始值
```js
// 操作数类型相同
1 + 3                    // => 4
'Hello' + ' ' + 'there'  // => "Hello there"
'1' + '2'                // => "12"
true + true              // => 2

// 操作数类型不同，会进行类型转换
// 如果其中一个操作数是字符串，那么另一个操作数优先转换为字符串进行计算
// 如果两个操作数都不是类字符串，那么进行算术加法计算
1 + '2'                  // => "12"
NaN + 'NaN'              // => "NaNNaN"
2 + 'a'                  // => "2a"
1 + null                 // 1 (Number(null) => 0)
2 + undefined            // NaN (Number(undefined) => NaN)
```

---

### “+” 与对象

操作数为对象时，则会遵循对象到原始值的转换规则转换为原始值进行计算

---

```js fontSize=16
2 + ( new Date( 2019, 10, 10 ))                       // => "${2 + ( new Date( 2019, 10, 10 ))}"
1 + {}                                                // => "1[object Object]"
1 + { x: 2, valueOf: function() { return this.x; }}   // => ${1 + { x: 2, valueOf: function() { return this.x; }}}

110 + {
  x: 3,
  valueOf: function() { return this.x; },
  toString: function() { return String( this.x ); }
}                                                     // => ${110 + { x: 3, valueOf: function() { return this.x; }, toString: function() { return String( this.x ); }}}

110 + {
  x: 3,
  toString: function() { return String( this.x ); }
}                                                     // => ${110 + { x: 3, toString: function() { return String( this.x ); }}}

// 对象会转换成原始值进行计算，转换时使用 valueOf 进行转换，除了日期对象
// 日期对象使用 toString 转换

```

---

### 一元运算符 - + -- ++

一元运算符作用于一个单独的操作数，有很高的优先级，都是右结合。

---

### 一元加法 和 一元减法

把操作数转换为数字，返回转换后的数字，减法则返回的数字符号相反。

```js
+"1"                                      // 1
+100                                      // 100
+{ valueOf: function() { return 1; }}     // ${+{valueOf:function(){ return 1; }}}
-"1"                                      // -1
-100                                      // -100
-{ valueOf: function() { return 1; }}     // ${-{valueOf:function(){ return 1; }}}
```

---

### ++ 和 --

把操作数转成数字，然后加(减)一，返回结果根据操作数位置不同有所差别，计算后的结果会赋值给操作数。

```js
// 操作数在后面则返回计算后的值，操作数在前面则返回计算前的操作数值
var i = 1;
++i                   // 2 此时 i 的值是3
i++                   // 2 此时 i 的值是3
// 可以看到最后的计算结果，效果与 i + 1 类似，但也不完全相同
// ++/-- 只会把操作数转成数字，与二元运算的 +/- 不同
var j = "1";
j + 1                 // "11"
++j                   // 2
```

---

### 位运算符

按位与(&) 按位或(|) 按位与或(^) 按位非(~) 左移(<<) 带符号右移(>>) 无符号右移(>>>)

---

### 二进制和位运算

二进制数是逢2进位的进位制，0、1 是基本算符。

```js
// 按位相与 1&1 => 1 , 1&0 => 0 , 0&0 => 0
// 00000111 & 00000011 => 00000011
7&3                 // 3
// 按位相或 1&1 => 1 , 1&0 => 1 , 0&0 => 0
// 00000111 | 00000011 => 00000111
7|3                 // 7
// 按位相异或 1&1 => 0 , 1&0 => 1 , 0&0 => 0
// 00000111 ^ 00000011 => 00000100
7^3                 // 4
// 按位非 ~1 => 0 , ~0 => 1
// 00000111 => 11111000 (实际口算时相当于：乘以-1再减1)
~7                  // -8
```

---

### 日常工作中比较少用到位运算

```js
// 左移一位
// 00000111 => 00001110
7 << 1            // 14
// 11111001 => 11110010
-7 << 1           // -14
// 右移一位
// 00000111 => 00000011
7 >> 1            // 3
// 11111001 => 11111100
-7 >> 1           // -4
// 无符号右移一位(左边永远补0与符号无关)
// 00000111 => 00000011
7 >>> 1           // 3
// 11111001 => 01111100
-7 >>> 1          // 2147483644
// JS中所有数组以双精度浮点数来存储，即64位
// 由于实际的存储机制比较复杂，我们这里可以简单认为整数小数各占32位
// 即 2147483644 是 32 位的运算结果
```

---

### 关系运算符

关系运算符用于测试两个值之间的关系，返回结果 false 或 true 。

---

### 相等和不等

== 和 === 都是判断是否相等，但是判断相等的定义有所不同，=== 是用来检测两个操作数否严格相等，
== 也是用来检测两个操作数是否相等的，但是这个相等定义是很宽松的，允许类型的转换。

!= 和 !== 检测规则与 == 和 === 的结果相反。

---

```js
1 == { valueOf: function() { return 1; }}       // ${1 == { valueOf: function() { return 1; }}}
1 === { valueOf: function() { return 1; }}      // ${1 === { valueOf: function() { return 1; }}}
1 == '1'                                        // ${1 == '1'}
1 === '1'                                       // ${1 === '1'}
false == 0                                      // ${false == 0}
undefined == null                               // ${undefined == null}
```

---

### 一般情况下请使用 === 和 !==

```js
1 == { valueOf: function() { return 1; }}       // ${1 == { valueOf: function() { return 1; }}}
1 === { valueOf: function() { return 1; }}      // ${1 === { valueOf: function() { return 1; }}}
1 == '1'                                        // ${1 == '1'}
1 === '1'                                       // ${1 === '1'}
false == 0                                      // ${false == 0}
undefined == null                               // ${undefined == null}
```
